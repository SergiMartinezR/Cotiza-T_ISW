{"ast":null,"code":"var _jsxFileName = \"/home/sergi/Documents/Repos/My_Repos/Cotiza-T_ISW/frontend/src/routes/Signup/Signup.js\";\nimport React, { Component } from 'react';\nimport './Signup.css';\nimport Navbar from '../../components/Navbar/Navbar';\nimport FormOne from './SignupForms/FormOne';\nimport FormTwo from './SignupForms/FormTwo';\nimport FormThree from './SignupForms/FormThree';\nimport Loader from '../../components/Loader/Loader';\nimport CustomAlert from '../../components/CustomAlert/CustomAlert';\nimport axios from '../../API/baseURL/baseURL';\nimport { Redirect } from 'react-router-dom';\nimport moment from 'moment';\n\nclass Signup extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      loading: null,\n      stage: this.props.match.params.id,\n      showAlert: null,\n      alertColor: null,\n      alertData: null,\n      redirect: null\n    };\n\n    this.submitFormOne = details => {\n      let userData = {\n        email: details.email,\n        password: details.password\n      }; // console.log(userData);\n\n      this.setState({\n        loading: true\n      });\n      axios.post('/user/create/', userData).then(res => {\n        this.setState({\n          loading: true\n        });\n        console.log(res);\n\n        if (res.status === 201) {\n          this.setState({\n            loading: false\n          });\n          let userId = res.data.id;\n          localStorage.setItem('userID', userId);\n          this.setState({\n            redirect: '2'\n          });\n        }\n\n        if (res.status === 226) {\n          this.setState({\n            loading: false,\n            showAlert: true,\n            alertData: 'Ya existe un usuario con este E-mail!',\n            alertColor: 'danger'\n          });\n        }\n      }).catch(err => {\n        console.log(err);\n        this.setState({\n          loading: false,\n          showAlert: true,\n          alertData: 'Todo lo que ha podido salir mal, lo ha hecho',\n          alertColor: 'danger'\n        });\n      }); // setTimeout(()=>{\n      //   this.setState({loading : false});\n      // },6000)\n    };\n\n    this.submitFormTwo = details => {\n      console.log(details);\n      let userId = localStorage.getItem('userID');\n      let userDetails = new FormData();\n      userDetails.append('first_name', details.firstName);\n      userDetails.append('last_name', details.lastName);\n\n      if (details.selectedFile !== null) {\n        userDetails.append('avatar', details.selectedFile);\n      }\n\n      userDetails.append('location', details.location);\n      userDetails.append('is_employed', !details.isStudent);\n      userDetails.append('organization_name', details.industry);\n      userDetails.append('position', details.position);\n      userDetails.append('start_date', moment(details.startDate).format('YYYY-MM-DD'));\n      userDetails.append('end_date', moment(details.endDate).format('YYYY-MM-DD'));\n      console.log(userDetails);\n      this.setState({\n        loading: true\n      });\n      axios.post(`/user/create/profile/${userId}/`, userDetails).then(res => {\n        console.log(res);\n\n        if (res.status === 201) {\n          this.setState({\n            loading: false\n          });\n          this.setState({\n            redirect: '3'\n          });\n          localStorage.setItem('profileID', res.data.id);\n        }\n      }).catch(err => {\n        console.log(err);\n        this.setState({\n          loading: false\n        });\n        this.setState({\n          showAlert: true,\n          alertData: 'Todo lo que ha podido salir mal, lo ha hecho',\n          alertColor: 'danger'\n        });\n      }); // let userId = '253';\n      // const userDetails = {\n      //   first_name : details.firstName,\n      //   last_name : details.lastName,\n      //   avatar : details.selectedFile,\n      //   location : details.location,\n      //   is_employed : details.isStudent,\n      //   organization_name : details.industry,\n      //   positon : details.position,\n      //   startYear : Number(details.startDate),\n      //   endYear : Number(details.endDate),\n      // }\n      // console.log(userDetails);\n    };\n\n    this.sendOTP = details => {\n      console.log(details);\n      let profileID = localStorage.getItem('profileID');\n      let sendOtpData = {\n        phone_number: details.phoneNumber,\n        profile_id: profileID\n      };\n      let userID = localStorage.getItem('userID'); // this.setState({loading : true});\n\n      axios.patch(`/user/create/profile/${userID}/`, sendOtpData).then(res => {\n        console.log(res); // this.setState({loading : false});\n\n        if (res.status === 202) {\n          this.setState({\n            showAlert: true,\n            alertData: 'OTP ha sido enviado a tu numero celular',\n            alertColor: 'success'\n          });\n        }\n      }).catch(err => {\n        console.log(err.response); // if(err.response.status === 403){\n        //   this.setState({\n        //     showAlert : true, \n        //     alertData : 'Phone number already linked to an account', \n        //     alertColor : 'danger'\n        //   })\n        // }\n\n        this.setState({\n          showAlert: true,\n          alertData: 'Este número celular ya esta relacionado con otra cuenta',\n          alertColor: 'danger'\n        }); // this.setState({loading : false});\n      });\n    };\n\n    this.verifyOTP = details => {\n      console.log(details);\n      let verifyOtpData = {\n        phone_number: details.phoneNumber,\n        otp: details.otp\n      }; // this.setState({loading : true});\n\n      this.setState({\n        showAlert: true,\n        alertData: 'Por favor espera en lo que verificamos tu número celular...',\n        alertColor: 'success'\n      });\n      axios.post('/user/account/verify/', verifyOtpData).then(res => {\n        console.log(res); // this.setState({loading : false});\n\n        if (res.status === 200) {\n          this.setState({\n            showAlert: true,\n            alertData: 'El número celular ha sido verificado con exito',\n            alertColor: 'success'\n          });\n          this.setState({\n            redirect: '4'\n          });\n        }\n      }).catch(err => {\n        console.log(err);\n        this.setState({\n          loading: false\n        });\n\n        if (err.response.status === 400) {\n          this.setState({\n            showAlert: true,\n            alertData: '¡OTP expirado!',\n            alertColor: 'danger'\n          });\n        }\n\n        if (err.response.status === 403) {\n          this.setState({\n            showAlert: true,\n            alertData: '¡OTP incorrecto!',\n            alertColor: 'danger'\n          });\n        }\n      });\n    };\n\n    this.showAlert = alertDetails => {\n      this.setState({\n        showAlert: true,\n        alertData: alertDetails.alertData,\n        alertColor: alertDetails.alertColor\n      });\n    };\n\n    this.hidePopup = () => {\n      this.setState({\n        showAlert: null\n      });\n    };\n  }\n\n  render() {\n    if (this.state.redirect === '2') {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/userSignup/personalDetails\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 14\n        }\n      });\n    }\n\n    if (this.state.redirect === '3') {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/userSignup/otpVerification\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 14\n        }\n      });\n    }\n\n    if (this.state.redirect === '4') {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/userLogin\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 14\n        }\n      });\n    }\n\n    let AlertData = null;\n\n    if (this.state.showAlert) {\n      AlertData = /*#__PURE__*/React.createElement(CustomAlert, {\n        hidePop: this.hidePopup,\n        color: this.state.alertColor,\n        content: this.state.alertData,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 9\n        }\n      });\n    }\n\n    let formData = /*#__PURE__*/React.createElement(FormOne, {\n      submitHandler: this.submitFormOne,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 20\n      }\n    });\n\n    if (this.state.stage === 'register') {\n      formData = /*#__PURE__*/React.createElement(FormOne, {\n        submitHandler: this.submitFormOne,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 18\n        }\n      });\n    }\n\n    if (this.state.stage === 'personalDetails') {\n      formData = /*#__PURE__*/React.createElement(FormTwo, {\n        submitHandler: this.submitFormTwo,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 18\n        }\n      });\n    }\n\n    if (this.state.stage === 'otpVerification') {\n      formData = /*#__PURE__*/React.createElement(FormThree, {\n        sendOTP: this.sendOTP,\n        verifyOTP: this.verifyOTP,\n        showAlert: this.showAlert,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 18\n        }\n      });\n    }\n\n    if (this.state.loading) {\n      formData = /*#__PURE__*/React.createElement(\"div\", {\n        className: \"loaderWindow\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Loader, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 11\n        }\n      }));\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Navbar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 9\n      }\n    }), AlertData, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"signupBody\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"signupForm\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 11\n      }\n    }, formData)));\n  }\n\n}\n\nexport default Signup;","map":{"version":3,"sources":["/home/sergi/Documents/Repos/My_Repos/Cotiza-T_ISW/frontend/src/routes/Signup/Signup.js"],"names":["React","Component","Navbar","FormOne","FormTwo","FormThree","Loader","CustomAlert","axios","Redirect","moment","Signup","state","loading","stage","props","match","params","id","showAlert","alertColor","alertData","redirect","submitFormOne","details","userData","email","password","setState","post","then","res","console","log","status","userId","data","localStorage","setItem","catch","err","submitFormTwo","getItem","userDetails","FormData","append","firstName","lastName","selectedFile","location","isStudent","industry","position","startDate","format","endDate","sendOTP","profileID","sendOtpData","phone_number","phoneNumber","profile_id","userID","patch","response","verifyOTP","verifyOtpData","otp","alertDetails","hidePopup","render","AlertData","formData"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport './Signup.css';\r\nimport Navbar from '../../components/Navbar/Navbar';\r\nimport FormOne from './SignupForms/FormOne';\r\nimport FormTwo from './SignupForms/FormTwo';\r\nimport FormThree from './SignupForms/FormThree';\r\nimport Loader from '../../components/Loader/Loader';\r\nimport CustomAlert from '../../components/CustomAlert/CustomAlert';\r\nimport axios from '../../API/baseURL/baseURL';\r\nimport { Redirect } from 'react-router-dom';\r\nimport moment from 'moment';\r\n\r\nclass Signup extends Component {\r\n\r\n  state = {\r\n    loading : null,\r\n    stage : this.props.match.params.id,\r\n    showAlert : null,\r\n    alertColor : null,\r\n    alertData : null,\r\n    redirect : null,\r\n  }\r\n\r\n  submitFormOne = (details) => {\r\n\r\n    let userData = {\r\n      email : details.email,\r\n      password : details.password,\r\n    }\r\n    // console.log(userData);\r\n    this.setState({ loading : true});\r\n\r\n    \r\n    axios.post('/user/create/',userData)\r\n      .then((res)=>{\r\n        this.setState({ loading : true});\r\n        console.log(res);\r\n        if(res.status === 201){\r\n          this.setState({ loading : false });\r\n          let userId = res.data.id;\r\n          localStorage.setItem('userID',userId);\r\n          this.setState({redirect : '2'});\r\n        }\r\n        if(res.status === 226){\r\n          this.setState({\r\n            loading : false,\r\n            showAlert : true, \r\n            alertData : 'Ya existe un usuario con este E-mail!', \r\n            alertColor : 'danger'\r\n          })\r\n        }\r\n      })\r\n      .catch((err)=>{\r\n        console.log(err);\r\n        this.setState({\r\n          loading : false,\r\n          showAlert : true, \r\n          alertData : 'Todo lo que ha podido salir mal, lo ha hecho', \r\n          alertColor : 'danger'\r\n        })\r\n      })\r\n    // setTimeout(()=>{\r\n    //   this.setState({loading : false});\r\n    // },6000)\r\n  }\r\n\r\n  submitFormTwo = (details) => {\r\n\r\n    console.log(details);\r\n\r\n    let userId = localStorage.getItem('userID');\r\n    let userDetails = new FormData();\r\n    userDetails.append('first_name',details.firstName);\r\n    userDetails.append('last_name',details.lastName);\r\n    if(details.selectedFile !== null){\r\n      userDetails.append('avatar',details.selectedFile);\r\n    }\r\n    userDetails.append('location',details.location);\r\n    userDetails.append('is_employed',!details.isStudent);\r\n    userDetails.append('organization_name',details.industry);\r\n    userDetails.append('position',details.position);\r\n    userDetails.append('start_date',moment(details.startDate).format('YYYY-MM-DD'));\r\n    userDetails.append('end_date',moment(details.endDate).format('YYYY-MM-DD'));\r\n\r\n    console.log(userDetails);\r\n    this.setState({loading : true});\r\n\r\n    axios.post(`/user/create/profile/${userId}/`,userDetails)\r\n      .then((res)=>{\r\n        console.log(res);\r\n        if(res.status === 201){\r\n          this.setState({loading : false});\r\n          this.setState({redirect : '3'});\r\n          localStorage.setItem('profileID',res.data.id);\r\n        }\r\n      })\r\n      .catch((err)=>{\r\n        console.log(err);\r\n        this.setState({loading : false});\r\n        this.setState({\r\n          showAlert : true, \r\n          alertData : 'Todo lo que ha podido salir mal, lo ha hecho', \r\n          alertColor : 'danger'\r\n        })      \r\n      })\r\n\r\n    // let userId = '253';\r\n    // const userDetails = {\r\n    //   first_name : details.firstName,\r\n    //   last_name : details.lastName,\r\n    //   avatar : details.selectedFile,\r\n    //   location : details.location,\r\n    //   is_employed : details.isStudent,\r\n    //   organization_name : details.industry,\r\n    //   positon : details.position,\r\n    //   startYear : Number(details.startDate),\r\n    //   endYear : Number(details.endDate),\r\n    // }\r\n    // console.log(userDetails);\r\n  }\r\n\r\n  sendOTP = (details) => {\r\n\r\n    console.log(details);\r\n    let profileID = localStorage.getItem('profileID');\r\n    let sendOtpData = {\r\n      phone_number : details.phoneNumber,\r\n      profile_id : profileID\r\n    }\r\n    let userID = localStorage.getItem('userID');\r\n    \r\n    // this.setState({loading : true});\r\n    axios.patch(`/user/create/profile/${userID}/`,sendOtpData)\r\n      .then((res)=>{\r\n        console.log(res);\r\n        // this.setState({loading : false});\r\n        if(res.status === 202){\r\n          this.setState({\r\n            showAlert : true, \r\n            alertData : 'OTP ha sido enviado a tu numero celular', \r\n            alertColor : 'success'\r\n          })\r\n        }\r\n      })\r\n      .catch((err)=>{\r\n        console.log(err.response)\r\n        // if(err.response.status === 403){\r\n        //   this.setState({\r\n        //     showAlert : true, \r\n        //     alertData : 'Phone number already linked to an account', \r\n        //     alertColor : 'danger'\r\n        //   })\r\n        // }\r\n        this.setState({\r\n          showAlert : true, \r\n          alertData : 'Este número celular ya esta relacionado con otra cuenta', \r\n          alertColor : 'danger'\r\n        })\r\n        // this.setState({loading : false});\r\n      })\r\n  }\r\n  \r\n  verifyOTP = (details) => {\r\n    console.log(details);\r\n    let verifyOtpData = {\r\n      phone_number : details.phoneNumber,\r\n      otp : details.otp\r\n    }\r\n    // this.setState({loading : true});\r\n    this.setState({\r\n      showAlert : true, \r\n      alertData : 'Por favor espera en lo que verificamos tu número celular...', \r\n      alertColor : 'success'\r\n    })\r\n    axios.post('/user/account/verify/',verifyOtpData)\r\n      .then((res)=>{\r\n        console.log(res);\r\n        // this.setState({loading : false});\r\n        if(res.status === 200){\r\n          this.setState({\r\n            showAlert : true, \r\n            alertData : 'El número celular ha sido verificado con exito', \r\n            alertColor : 'success'\r\n          })\r\n          this.setState({redirect : '4'});\r\n        }\r\n      })\r\n      .catch((err)=>{\r\n        console.log(err);\r\n        this.setState({loading : false});\r\n        if(err.response.status === 400){\r\n          this.setState({\r\n            showAlert : true, \r\n            alertData : '¡OTP expirado!', \r\n            alertColor : 'danger'\r\n          })\r\n        }\r\n        if(err.response.status === 403){\r\n          this.setState({\r\n            showAlert : true, \r\n            alertData : '¡OTP incorrecto!', \r\n            alertColor : 'danger'\r\n          })\r\n        }\r\n      })\r\n  }\r\n\r\n\r\n  showAlert = (alertDetails) => {\r\n    this.setState({showAlert : true , alertData : alertDetails.alertData , alertColor : alertDetails.alertColor});  \r\n  }\r\n\r\n  hidePopup = () => {\r\n    this.setState({showAlert : null});\r\n  }\r\n\r\n  render() {\r\n\r\n    if(this.state.redirect === '2'){\r\n      return <Redirect to='/userSignup/personalDetails'/>\r\n    }\r\n    if(this.state.redirect === '3'){\r\n      return <Redirect to='/userSignup/otpVerification'/>\r\n    }\r\n    if(this.state.redirect === '4'){\r\n      return <Redirect to='/userLogin'/>\r\n    }\r\n\r\n    let AlertData = null;\r\n    if(this.state.showAlert){\r\n      AlertData = (\r\n        <CustomAlert hidePop={this.hidePopup} color={this.state.alertColor} content={this.state.alertData}/>\r\n      )\r\n    }\r\n\r\n    let formData = <FormOne submitHandler={this.submitFormOne}/>;\r\n\r\n    if(this.state.stage === 'register'){\r\n      formData = <FormOne submitHandler={this.submitFormOne}/>\r\n    }\r\n    if(this.state.stage === 'personalDetails'){\r\n      formData = <FormTwo submitHandler={this.submitFormTwo}/>\r\n    }\r\n    if(this.state.stage === 'otpVerification'){\r\n      formData = <FormThree sendOTP={this.sendOTP} verifyOTP={this.verifyOTP} showAlert={this.showAlert}/>\r\n    }\r\n\r\n    if(this.state.loading){\r\n      formData = (\r\n        <div className='loaderWindow'>\r\n          <Loader/>\r\n        </div>\r\n      )\r\n    }\r\n\r\n    return (\r\n      <div>\r\n        <Navbar/>\r\n        {AlertData}\r\n        <div className='signupBody'>\r\n          <div className='signupForm'>\r\n            {formData}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Signup;"]},"metadata":{},"sourceType":"module"}